---
import Section from "./Section.astro";

const title = "Servicios";
const subtitle = "Conoce nuestros servicios";
---

<Section title={title} subtitle={subtitle} color="white" id="servicios">
  <!-- Contenedor principal con fondo e imagen -->
  <section
    class="relative bg-[#13151a] text-white py-16 min-h-auto overflow-hidden"
  >
    <div slot="body" class="relative z-20 px-8 mx-auto max-w-7xl">
      <h2 class="text-3xl font-bold text-center">{title}</h2>
      <p class="mt-4 text-lg text-center text-gray-300">{subtitle}</p>
    </div>
  </section>

  <!-- Contenedor de Videos y Antes/Después alineados horizontalmente -->
  <div slot="body" class="flex flex-wrap justify-center gap-4 mt-8">
    <!-- Video 1 -->
    <div
      class="w-full max-w-xs mx-auto overflow-hidden shadow-lg sm:max-w-sm lg:max-w-md"
    >
      <div class="relative">
        <video
          id="video-exterior"
          muted
          autoplay
          loop
          class="object-cover w-full h-full rounded-2xl"
        >
          <source src="../public/Exterior.mp4" type="video/mp4" />
        </video>
        <!-- Fondo gris con texto -->
        <div
          class="absolute inset-0 flex items-center justify-center text-white transition-opacity duration-300 opacity-100 bg-black/50"
          id="text-exterior"
        >
          <p class="text-lg">Servicio Exterior</p>
        </div>
      </div>
    </div>

    <!-- Video 2 -->
    <div
      class="w-full max-w-xs mx-auto overflow-hidden shadow-lg sm:max-w-sm lg:max-w-md"
    >
      <div class="relative">
        <video
          id="video-interior"
          muted
          autoplay
          loop
          class="object-cover w-full h-full rounded-2xl"
        >
          <source src="../public/Interior.mp4" type="video/mp4" />
        </video>
        <!-- Fondo gris con texto -->
        <div
          class="absolute inset-0 flex items-center justify-center text-white transition-opacity duration-300 opacity-100 bg-black/50"
          id="text-interior"
        >
          <p class="text-lg">Servicio Interior</p>
        </div>
      </div>
    </div>

    <!-- Imagen Antes y Después -->
    <div
      class="relative w-full max-w-xs mx-auto overflow-hidden rounded-lg shadow-lg sm:max-w-sm lg:max-w-md group"
    >
      <!-- Imagen "Antes" -->
      <img
        src="../public/Antes.jpeg"
        alt="Antes del servicio"
        class="w-full h-full transition-opacity duration-300 group-hover:opacity-0"
      />
      <!-- Imagen "Después" -->
      <img
        src="../public/Despues.jpeg"
        alt="Después del servicio"
        class="absolute top-0 left-0 w-full h-full transition-opacity duration-300 opacity-0 group-hover:opacity-100"
      />
      <!-- Fondo gris con texto -->
      <div
        class="absolute inset-0 flex items-center justify-center text-white transition-opacity duration-300 opacity-100 bg-black/50"
        id="text-completo"
      >
        <p class="text-lg">Servicio Completo</p>
      </div>
    </div>
  </div>

  <img
    slot="background"
    id="bg-image-modely"
    src="../public/Servicios.jpg"
    alt="Background Servicios"
    class="absolute inset-0 z-0 object-cover w-full h-full pointer-events-none opacity-10"
  />

  <!-- Botones -->
  <section slot="footer" class="flex justify-center mx-auto mt-12 gap-x-6">
    <a
      class="inline-flex items-center justify-center px-12 py-2 text-sm font-medium text-white transition-colors rounded bg-cyan-700 hover:bg-slate-400 hover:text-white"
      href="#"
    >
      Agendar
    </a>
    <a
      class="inline-flex items-center justify-center px-12 py-2 text-sm font-medium text-black transition-colors bg-white rounded hover:bg-slate-900 hover:text-white"
      href="#"
    >
      Precios
    </a>
  </section>
</Section>

<script>
  document.addEventListener("DOMContentLoaded", function () {
    function isEdge() {
      if (
        navigator.userAgent.indexOf("Edge") > -1 ||
        navigator.userAgent.indexOf("Edg") > -1
      ) {
        return true;
      } else {
        return false;
      }
    }

    let imageElement = document.querySelector(
      "#bg-image-modely"
    ) as HTMLImageElement;

    if (isEdge()) {
      imageElement.src = "/Servicios.jpg"; // Ruta corregida
    } else {
      imageElement.src = "/Servicios.webp"; // Ruta corregida
    }
  });

  document.addEventListener("DOMContentLoaded", function () {
    // Función para ocultar el texto cuando se hace click en un video
    function hideText(videoId: string, textId: string): void {
      // Definir tipo de los parámetros
      const video = document.getElementById(videoId) as HTMLVideoElement | null;
      const text = document.getElementById(textId) as HTMLElement | null;

      // Cuando el video se hace click, ocultamos el texto
      if (video && text) {
        video.addEventListener("click", function () {
          text.style.opacity = "0"; // Hace desaparecer el texto
        });
      }
    }

    // Aplicar la función a los videos y sus textos correspondientes
    hideText("video-exterior", "text-exterior");
    hideText("video-interior", "text-interior");

    // Para la imagen de Antes/Después
    const imageGroup = document.querySelector(".group") as HTMLElement | null;
    const textCompleto = document.getElementById(
      "text-completo"
    ) as HTMLElement | null;

    if (imageGroup && textCompleto) {
      imageGroup.addEventListener("click", function () {
        textCompleto.style.opacity = "0"; // Oculta el texto para el servicio completo
      });
    }
  });
</script>
